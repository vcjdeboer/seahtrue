<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="seahtrue">
<title>Plot • seahtrue</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot">
<meta property="og:description" content="seahtrue">
<meta property="og:image" content="https://vcjdeboer.github.io/seahtrue/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">seahtrue</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/seahtrue.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/revive.html">Revive</a>
    <a class="dropdown-item" href="../articles/inspect.html">Inspect</a>
    <a class="dropdown-item" href="../articles/plot.html">Plot</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="http://github.com/vcjdeboer/seahtrue" aria-label="Github">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/vcjdeboer" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot</h1>
            
      
      
      <div class="d-none name"><code>plot.Rmd</code></div>
    </div>

    
    
<p>Generating visual output of the revived data can be done in multiple
ways. We will provide a number of examples here.</p>
<div class="section level4">
<h4 id="plate-maps">Plate maps<a class="anchor" aria-label="anchor" href="#plate-maps"></a>
</h4>
<p>Typically, scientists use multiple conditions in their 96 well plate
set-up. These conditions are labeled as groups. Each group typically is
associated with multiple wells. We can plot a plate-map using the
<code>sketch_plate()</code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">revive_output_donor_A</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"raw_data"</span>, <span class="fl">1</span><span class="op">)</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu">sketch_plate</span><span class="op">(</span>reorder_legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Apart from using the build in function for the most common type of
plate map often needed, we can build our a heatmap with OCR data as
well. We now use a similar ggplot script as in the
<code>sketch_plate()</code> function but adapt to our liking show OCR
instead of groups.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">revive_output_donor_A</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"rate_data"</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span>, .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">well</span>, </span>
<span>                    into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="st">"column"</span><span class="op">)</span>, </span>
<span>                    sep <span class="op">=</span> <span class="fl">1</span>,  </span>
<span>                    convert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">column</span>, y <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="va">row</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">geom_tile</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">OCR_wave_bc</span><span class="op">)</span>,</span>
<span>                color <span class="op">=</span> <span class="st">"grey50"</span>,show.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">+</span></span>
<span>      <span class="fu">colorspace</span><span class="fu">::</span><span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/scale_colour_continuous_sequential.html" class="external-link">scale_fill_continuous_sequential</a></span><span class="op">(</span></span>
<span>        palette <span class="op">=</span> <span class="st">"YlGnBu"</span>, </span>
<span>        rev<span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        name <span class="op">=</span> <span class="st">"OCR (pmol/min)"</span><span class="op">)</span><span class="op">+</span></span>
<span>      <span class="fu">scale_x_continuous</span><span class="op">(</span>limits<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">12.5</span><span class="op">)</span>,</span>
<span>                        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>,</span>
<span>                        position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span><span class="op">+</span></span>
<span>      <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">%+replace%</span> </span>
<span>        <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>              panel.border <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>              axis.ticks <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span><span class="op">)</span>,</span>
<span>              axis.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>              axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.3</span><span class="op">)</span>,</span>
<span>                                          hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                         vjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>              axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.3</span><span class="op">)</span>,</span>
<span>                                         hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                         vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>              legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Furthermore, we can annotate the wells with text as well. For example
with the cell number:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">revive_output_donor_A</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"rate_data"</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span>, .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">well</span>, </span>
<span>                    into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="st">"column"</span><span class="op">)</span>, </span>
<span>                    sep <span class="op">=</span> <span class="fl">1</span>,  </span>
<span>                    convert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">column</span>, y <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="va">row</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">geom_tile</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">OCR_wave_bc</span><span class="op">)</span>,</span>
<span>                color <span class="op">=</span> <span class="st">"grey50"</span>,show.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">+</span></span>
<span>      <span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cell_n</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">colorspace</span><span class="fu">::</span><span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/scale_colour_continuous_sequential.html" class="external-link">scale_fill_continuous_sequential</a></span><span class="op">(</span></span>
<span>        palette <span class="op">=</span> <span class="st">"YlGnBu"</span>, </span>
<span>        rev<span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        name <span class="op">=</span> <span class="st">"OCR (pmol/min)"</span><span class="op">)</span><span class="op">+</span></span>
<span>      <span class="fu">scale_x_continuous</span><span class="op">(</span>limits<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">12.5</span><span class="op">)</span>,</span>
<span>                        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>,</span>
<span>                        position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span><span class="op">+</span></span>
<span>      <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">%+replace%</span> </span>
<span>        <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>              panel.border <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>              axis.ticks <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span><span class="op">)</span>,</span>
<span>              axis.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>              axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.3</span><span class="op">)</span>,</span>
<span>                                          hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                         vjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>              axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.3</span><span class="op">)</span>,</span>
<span>                                         hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                         vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>              legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="rate-plot">Rate plot<a class="anchor" aria-label="anchor" href="#rate-plot"></a>
</h4>
<p>The most common plot that is often seen in papers is the rate plot.
This shows most of the time the OCR (or ECAR) traces per group over
time, demonstrating the different phases of an XF assay, such as basal,
maximal and non-mitochondrial OCR. The sketch_rate() function can be
used for this. It has some options that we will explore here.</p>
<p>First, let’s plot the OCR for each group in an assy over time. Please
note that the shaded area is the 50% middle quantiles as generated by
the R <code>quantile</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">revive_output_donor_A</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"rate_data"</span>, <span class="fl">1</span><span class="op">)</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu">sketch_rate</span><span class="op">(</span>reorder_legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>It can also be informative to observe all OCR of each individual
well. This could be used to spot technical outliers.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">revive_output_donor_A</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"rate_data"</span>, <span class="fl">1</span><span class="op">)</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu">sketch_rate</span><span class="op">(</span>reorder_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              take_group_mean <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_files/figure-html/unnamed-chunk-7-1.png" width="700">
Since XF data needs to be properly normalized to cell number in each,
this option can be selected. If the cell numbers were in the original
.xlsx input file, the <code>cell_n</code> column contains these
normalization values:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">revive_output_donor_A</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"rate_data"</span>, <span class="fl">1</span><span class="op">)</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu">sketch_rate</span><span class="op">(</span>param <span class="op">=</span> <span class="st">"OCR"</span>,</span>
<span>              reorder_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              take_group_mean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              normalize_unit <span class="op">=</span> <span class="st">"1000"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Similar plots can be generated for ECAR.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">revive_output_donor_A</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"rate_data"</span>, <span class="fl">1</span><span class="op">)</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu">sketch_rate</span><span class="op">(</span>param <span class="op">=</span> <span class="st">"ECAR"</span>,</span>
<span>              reorder_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              take_group_mean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              normalize_unit <span class="op">=</span> <span class="st">"1000"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Or for single wells:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">revive_output_donor_A</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"rate_data"</span>, <span class="fl">1</span><span class="op">)</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu">sketch_rate</span><span class="op">(</span>param <span class="op">=</span> <span class="st">"ECAR"</span>,</span>
<span>              reorder_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              take_group_mean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              normalize_unit <span class="op">=</span> <span class="st">"1000"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="multiple-plates">Multiple plates<a class="anchor" aria-label="anchor" href="#multiple-plates"></a>
</h4>
<p>To be able to inspect, compare and visulaize multiple plates the
<code>glue_xfplates()</code> function can be used. This reads in either
a path to a folder or a vector with a strings containing a full file
path to .xlsx XF files. If the argument is a folder path the
<code>arg_is_folder</code> argument should be <code>TRUE</code>, if
vector it should be <code>FALSE</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">my_filepath_vector</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>      <span class="st">"20191219_SciRep_PBMCs_donor_A.xlsx"</span>, </span>
<span>      package <span class="op">=</span> <span class="st">"seahtrue"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>      <span class="st">"20200110_SciRep_PBMCs_donor_B.xlsx"</span>, </span>
<span>      package <span class="op">=</span> <span class="st">"seahtrue"</span><span class="op">)</span>,</span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>      <span class="st">"20200110_SciRep_PBMCs_donor_C.xlsx"</span>, </span>
<span>      package <span class="op">=</span> <span class="st">"seahtrue"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">revived_donors</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">my_filepath_vector</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu">glue_xfplates</span><span class="op">(</span>arg_is_folder <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Start function to read seahorse plate data from Excel file:</span></span>
<span><span class="co">#&gt; 20191219_SciRep_PBMCs_donor_A.xlsx</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Finished collecting assay information.</span></span>
<span><span class="co">#&gt; → plateid is identified as:V0174416419V</span></span>
<span><span class="co">#&gt; → Rate was exported WITH background correction</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Finished preprocessing of the input data</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Finished validating the input data</span></span>
<span><span class="co">#&gt; → Start function to read seahorse plate data from Excel file:</span></span>
<span><span class="co">#&gt; 20200110_SciRep_PBMCs_donor_B.xlsx</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Finished collecting assay information.</span></span>
<span><span class="co">#&gt; → plateid is identified as:V0194115019V</span></span>
<span><span class="co">#&gt; → Rate was exported WITH background correction</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Finished preprocessing of the input data</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Finished validating the input data</span></span>
<span><span class="co">#&gt; → Start function to read seahorse plate data from Excel file:</span></span>
<span><span class="co">#&gt; 20200110_SciRep_PBMCs_donor_C.xlsx</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Finished collecting assay information.</span></span>
<span><span class="co">#&gt; → plateid is identified as:V0194715019V</span></span>
<span><span class="co">#&gt; → Rate was exported WITH background correction</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Finished preprocessing of the input data</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Finished validating the input data</span></span>
<span></span>
<span></span>
<span><span class="va">revived_donors</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 9</span></span></span>
<span><span class="co">#&gt;   plate_id     filepath_seahorse date_run         date_processed      assay_info</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> V0174416419V <span style="color: #949494;">&lt;tibble [1 × 3]&gt;</span>  19-12-2019 17:25 2024-04-19 <span style="color: #949494;">09:02:39</span> <span style="color: #949494;">&lt;tibble&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> V0194115019V <span style="color: #949494;">&lt;tibble [1 × 3]&gt;</span>  10-1-2020 16:59  2024-04-19 <span style="color: #949494;">09:02:50</span> <span style="color: #949494;">&lt;tibble&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> V0194715019V <span style="color: #949494;">&lt;tibble [1 × 3]&gt;</span>  15-1-2020 17:26  2024-04-19 <span style="color: #949494;">09:03:00</span> <span style="color: #949494;">&lt;tibble&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: injection_info &lt;list&gt;, raw_data &lt;list&gt;, rate_data &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   validation_output &lt;list&gt;</span></span></span></code></pre></div>
<p>Next, we can unnest particular data tibbles which combines the data
of the three plates into one tibble.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">revived_donors</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">plate_id</span>, <span class="st">"raw_data"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">raw_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 41,472 × 22</span></span></span>
<span><span class="co">#&gt;    plate_id   well  measurement  tick timescale minutes group interval injection</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> V01744164… A01             1     0         0       0 Back…        1 Baseline </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> V01744164… A02             1     0         0       0 50.0…        1 Baseline </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> V01744164… A03             1     0         0       0 100.…        1 Baseline </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> V01744164… A04             1     0         0       0 100.…        1 Baseline </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> V01744164… A05             1     0         0       0 150.…        1 Baseline </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> V01744164… A06             1     0         0       0 200.…        1 Baseline </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> V01744164… A07             1     0         0       0 150.…        1 Baseline </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> V01744164… A08             1     0         0       0 200.…        1 Baseline </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> V01744164… A09             1     0         0       0 250.…        1 Baseline </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> V01744164… A10             1     0         0       0 250.…        1 Baseline </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 41,462 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 13 more variables: O2_em_corr &lt;dbl&gt;, pH_em_corr &lt;dbl&gt;, O2_mmHg &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   pH &lt;dbl&gt;, pH_em_corr_corr &lt;dbl&gt;, O2_em_corr_bkg &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   pH_em_corr_bkg &lt;dbl&gt;, O2_mmHg_bkg &lt;dbl&gt;, pH_bkgd &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   pH_em_corr_corr_bkg &lt;dbl&gt;, bufferfactor &lt;dbl&gt;, cell_n &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   flagged_well &lt;lgl&gt;</span></span></span></code></pre></div>
<p>The <code>sketch_assimilate_rate()</code> function plots the OCR for
specific measurements that are given in the <code>my_measurements</code>
argument for each well. The three different plates are faceted into
separate panels. The plate barcode is given as facet title. Also the
dots (representing a well) are color based on their interval in the XF
experiment. This information comes from the <code>injection_info</code>
tibble. In our demo data the first interval is initial OCR, the second
interval is the FCCP-induced OCR and the third and fourth interval are
antimycin/rotenone induced OCR.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">revived_donors</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">sketch_assimilate_rate</span><span class="op">(</span>my_measurements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">9</span>,<span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>A similar plot can be generaetd for ECAR:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">revived_donors</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">sketch_assimilate_rate</span><span class="op">(</span>param <span class="op">=</span> <span class="st">"ECAR"</span>,</span>
<span>                         my_measurements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">9</span>,<span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_files/figure-html/unnamed-chunk-14-1.png" width="700">
Also, we could plot only the measurments belonging to the initial ECAR
and final ECAR by changing the <code>my_measurements</code> vector. This
shows the initial and maximal ECAR for each group in all three plates
cmobined.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">revived_donors</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">sketch_assimilate_rate</span><span class="op">(</span>param <span class="op">=</span> <span class="st">"ECAR"</span>,</span>
<span>                         my_measurements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="plot-multiple-plate-with-raw-data">Plot multiple plate with raw data<a class="anchor" aria-label="anchor" href="#plot-multiple-plate-with-raw-data"></a>
</h4>
<p>If we combine the raw data tibbles form the three plates we can get
insights into the raw O2 or pH levels. For example, by plotting the
first tick, whcih is the first point of the first measurement, for each
well in each plate a distribution is observed around the target O2.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">revived_donors</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">sketch_assimilate_raw</span><span class="op">(</span>param <span class="op">=</span> <span class="st">"O2_mmHg"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 0.934</span></span></code></pre></div>
<p><img src="plot_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>And the same can be done for the emission of the pH values for
example:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">revived_donors</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">sketch_assimilate_raw</span><span class="op">(</span>param <span class="op">=</span> <span class="st">"pH_em_corr"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 114</span></span></code></pre></div>
<p><img src="plot_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Vincent de Boer, Gerwin Smits, Xiang Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
